{% set tabId = 'tab-metadata' %}

<div class="mdtab-content act" data-mdtab-content="metadata">
    <h1 class="title">{% trans %}Metadaten{% endtrans %}</h1>



    <div class="grid space responsive">
        <div class="row r-2">
            <div class="col c-1-2">
                {{ profileForm.x_select({
                    'name'            : 'p[metadataLanguage]',
                    'label'           : 'Sprache der Metadaten',
                    'default'         : 'ger',
                    'validatorSources': tabId,
                    'hasList'         : true,
                    'defaultList'     : {
                        'ger': 'Deutsch',
                        'eng': 'Englisch'
                    },
                    'p'               : p
                }) }}
            </div>
            <div class="col c-1-2"></div>
        </div>
    </div>

    <h2 class="title">{% trans %}Für Metadaten verantwortliche Stelle{% endtrans %}</h2>

    {% set id = 'p[responsiblePartyMetadata]' %}
    {% if p['responsiblePartyMetadata'] is not defined %}
        {% set p = p|merge({'responsiblePartyMetadata': [{}]}) %}
    {% endif %}

    <div class="duplicatable-area -js-duplicatable-area" data-count="{{ p['responsiblePartyMetadata']|length }}">
        <div class="form-field-wrapper i4" id="{{ id|md_id }}">
            <span class="form-icon-type icon-mandatory rs left -js-validation-icon" data-validation-icon="icon-mandatory"></span>
            <div class="advanced-select -js-advanced-select">
                {% if p['responsiblePartyMetadata']|first['organisationName'] is defined %}
                    <span class="-js-current-title-label">{{ p['responsiblePartyMetadata']|first['organisationName'] }}</span>
                {% endif %}
                <div class="advanced-select-options -js-advanced-select-options">
                    {% for responsibleParty in p['responsiblePartyMetadata'] %}
                        <div class="advanced-select-option -js-advanced-select-option {% if loop.index0 == 0 %}act{% endif %}" data-tab="{{ loop.index0 }}">
                            {% if responsibleParty.organisationName is defined %}
                                <span class="-js-title-label">{{ responsibleParty.organisationName }}</span>
                            {% endif %}
                            <span class="form-icon icon-bin2 right -js-duplicatable-area-remove"></span>
                        </div>
                    {% endfor %}
                </div>
            </div>
            <span class="form-icon icon-question2 right -js-show-help" {{ id|md_data_obj }}></span>
            <span class="form-icon icon-plus right -js-duplicatable-area-add"></span>
            <span class="form-icon -js-data-count-label">{{ p['responsiblePartyMetadata']|length }}</span>
        </div>
        <div class="duplicatable-content -js-duplicatable-content">
            {% for responsibleParty in array_get(p, 'responsiblePartyMetadata', [{}], true) %}
                <div data-tab-content="{{ loop.index0 }}" class="duplicatable-content-item {% if loop.index0 == 0 %}act{% endif %}">
                    <div class="grid space responsive">
                        <div class="row r-2">
                            <div class="col c-1-2">
                                {{ profileForm.x_input({
                                    'name'            : 'p[responsiblePartyMetadata][' ~ loop.index0 ~ '][organisationName]',
                                    'label'           : 'Name der Organisation',
                                    'validatorSources': tabId ~ ',' ~ id|md_id,
                                    'class'           : '-js-duplicatable-title',
                                    'p'               : p
                                }) }}
                            </div>
                            <div class="col c-1-2">
                                {{ profileForm.x_input({
                                    'name'            : 'p[responsiblePartyMetadata][' ~ loop.index0 ~ '][electronicMailAddress]',
                                    'label'           : 'E-Mail',
                                    'validatorSources': tabId ~ ',' ~ id|md_id,
                                    'p'               : p
                                }) }}
                            </div>
                        </div>

                        <div class="row r-2">
                            <div class="col c-1-2">
                                {{ profileForm.x_input({
                                    'name'            : 'p[responsiblePartyMetadata][' ~ loop.index0 ~ '][individualName]',
                                    'label'           : 'Zuständige Person',
                                    'type'            : 'conditional',
                                    'validatorSources': tabId ~ ',' ~ id|md_id,
                                    'p'               : p
                                }) }}
                            </div>
                            <div class="col c-1-2"></div>
                        </div>

                        <div class="row r-2">
                            <div class="col c-1-2">
                                {{ profileForm.x_input({
                                    'name'            : 'p[responsiblePartyMetadata][' ~ loop.index0 ~ '][country]',
                                    'label'           : 'Staat',
                                    'type'            : 'optional',
                                    'validatorSources': tabId ~ ',' ~ id|md_id,
                                    'p'               : p
                                }) }}
                            </div>
                            <div class="col c-1-2">
                                {{ profileForm.x_input({
                                    'name'            : 'p[responsiblePartyMetadata][' ~ loop.index0 ~ '][administrativeArea]',
                                    'label'           : 'Bundesland',
                                    'type'            : 'optional',
                                    'validatorSources': tabId ~ ',' ~ id|md_id,
                                    'p'               : p
                                }) }}
                            </div>
                        </div>

                        <div class="row r-1">
                            <div class="col c-1">
                                {{ profileForm.x_input({
                                    'name'            : 'p[responsiblePartyMetadata][' ~ loop.index0 ~ '][deliveryPoint]',
                                    'label'           : 'Straße und Hausnummer / Postfach',
                                    'type'            : 'optional',
                                    'validatorSources': tabId ~ ',' ~ id|md_id,
                                    'p'               : p
                                }) }}
                            </div>
                        </div>

                        <div class="row r-2">
                            <div class="col c-1-2">
                                {{ profileForm.x_input({
                                    'name'            : 'p[responsiblePartyMetadata][' ~ loop.index0 ~ '][city]',
                                    'label'           : 'Ort',
                                    'type'            : 'optional',
                                    'validatorSources': tabId ~ ',' ~ id|md_id,
                                    'p'               : p
                                }) }}
                            </div>
                            <div class="col c-1-2">
                                {{ profileForm.x_input({
                                    'name'            : 'p[responsiblePartyMetadata][' ~ loop.index0 ~ '][postalCode]',
                                    'label'           : 'PLZ',
                                    'type'            : 'optional',
                                    'validatorSources': tabId ~ ',' ~ id|md_id,
                                    'p'               : p
                                }) }}
                            </div>
                        </div>

                        <div class="row r-2">
                            <div class="col c-1-2">
                                {{ profileForm.x_input({
                                    'name'            : 'p[responsiblePartyMetadata][' ~ loop.index0 ~ '][voice]',
                                    'label'           : 'Telefonnummer',
                                    'type'            : 'optional',
                                    'validatorSources': tabId ~ ',' ~ id|md_id,
                                    'p'               : p
                                }) }}
                            </div>
                            <div class="col c-1-2">
                                {{ profileForm.x_input({
                                    'name'            : 'p[responsiblePartyMetadata][' ~ loop.index0 ~ '][facsimile]',
                                    'label'           : 'Faxnummer',
                                    'type'            : 'optional',
                                    'validatorSources': tabId ~ ',' ~ id|md_id,
                                    'p'               : p
                                }) }}
                            </div>
                        </div>

                        <div class="row r-1">
                            <div class="col c-1">
                                {{ profileForm.x_input({
                                    'name'            : 'p[responsiblePartyMetadata][' ~ loop.index0 ~ '][onlineResource]',
                                    'label'           : 'Internetadresse',
                                    'type'            : 'optional',
                                    'validatorSources': tabId ~ ',' ~ id|md_id,
                                    'p'               : p
                                }) }}
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    <div class="grid space responsive">
        <div class="row r-1">
            <div class="col c-1">
                <h2 class="title">{% trans %}Angaben zur Metadatenspezifikation{% endtrans %}</h2>
            </div>
        </div>
        <div class="row r-2">
            <div class="col c-1-2">
                {{ profileForm.x_input({
                    'name'            : 'p[metadataStandardName]',
                    'label'           : 'Spezifikation',
                    'validatorSources': tabId,
                    'placeholder'     : 'ISO 19119',
                    'p'               : p
                }) }}
            </div>
            <div class="col c-1-2">
                {{ profileForm.x_input({
                    'name'            : 'p[metadataStandardVersion]',
                    'label'           : 'Version',
                    'validatorSources': tabId,
                    'placeholder'     : '2005/PDAM 1',
                    'p'               : p
                }) }}
            </div>
        </div>
        <div class="row r-1">
            <div class="col c-1">
                {{ profileForm.x_input({
                    'name'            : 'p[browserGraphic]',
                    'label'           : 'Browser Bild',
                    'validatorSources': tabId,
                    'type'            : 'optional',
                    'class'           : '-js-update-preview-image',
                    'p'               : p
                }) }}
            </div>
        </div>
    </div>
</div>
